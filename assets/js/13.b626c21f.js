(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{181:function(t,e,a){t.exports=a.p+"assets/img/WechatIMG1342.09acbb94.png"},232:function(t,e,a){"use strict";a.r(e);var _=[function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("div",{staticClass:"content"},[_("h1",{attrs:{id:"mmm"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#mmm","aria-hidden":"true"}},[t._v("#")]),t._v(" MMM")]),t._v(" "),_("h2",{attrs:{id:"功能："}},[_("a",{staticClass:"header-anchor",attrs:{href:"#功能：","aria-hidden":"true"}},[t._v("#")]),t._v(" 功能：")]),t._v(" "),_("ul",[_("li",[_("h4",[t._v("MMM监控Mysql主从复制的健康情况，链路是否正常，主从是否存在延迟。")])]),t._v(" "),_("li",[_("h4",[t._v("当出现主从延迟时，或者主从复制链路中断时，会对主服务进行故障转移，并且将虚拟IP迁移到新的主上。自动配置其他从对新主的复制。")])]),t._v(" "),_("li",[_("h4",[t._v("提供了主，写虚拟IP，在主从服务器出现问题时，可以自动迁移虚拟IP。")]),t._v(" "),_("ul",[_("li",[_("p",[t._v("对每一个服务器，都会提供一个虚拟IP，其中包括一个写的虚IP和多个读的虚IP。")])]),t._v(" "),_("li",[_("p",[t._v("写的虚IP只能在两个主服务器之间，进行切换")])]),t._v(" "),_("li",[_("p",[t._v("读的虚IP则可以在集群所有机器上进行切换")])])])])]),t._v(" "),_("h2",{attrs:{id:"faq"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#faq","aria-hidden":"true"}},[t._v("#")]),t._v(" Faq")]),t._v(" "),_("ul",[_("li",[_("h4",[t._v("出现故障自动故障转移，并且配置其他从对新主的复制时，要解决的问题")]),t._v(" "),_("ul",[_("li",[_("h5",[t._v("如何找到从库对应的新的主库日志点的日志同步点")])]),t._v(" "),_("li",[_("h5",[t._v("如果存在多个从库出现数据不一致的情况如何处理")])])]),t._v(" "),_("div",{staticClass:"warning custom-block"},[_("p",{staticClass:"custom-block-title"},[t._v("结论")]),t._v(" "),_("p",[t._v("MMM对这快的处理并不安全，只是简单粗暴的找到新的主库的日志点，然后使所有的从库对这个日志点来进行同步。在繁忙的系统中，可能会造成数据丢失的情况。")])])])]),t._v(" "),_("h2",{attrs:{id:"工作模式"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#工作模式","aria-hidden":"true"}},[t._v("#")]),t._v(" 工作模式")]),t._v(" "),_("ul",[_("li",[_("h4",[t._v("拓扑图")]),t._v(" "),_("img",{staticStyle:{width:"500px"},attrs:{src:a(181)}})]),t._v(" "),_("li",[_("h4",[t._v("主动被动模式的主主复制")]),t._v(" "),_("ul",[_("li",[t._v("只有一个主，对外提供服务")]),t._v(" "),_("li",[t._v("另外一个主处于备用状态，只能用于查询，并且设置为"),_("code",[t._v("Read-only模式")])])])])]),t._v(" "),_("h2",{attrs:{id:"部署资源"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#部署资源","aria-hidden":"true"}},[t._v("#")]),t._v(" 部署资源")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("资源名称")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("数量")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("说明")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("主DB服务器")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("2")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("用于主备模式的主主复制配置")])]),t._v(" "),_("tr",[_("td",[t._v("从DB服务器")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("0-N")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("可以配置0台或多台从服务器")])]),t._v(" "),_("tr",[_("td",[t._v("监控服务器")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("用于监控MySQL复制集群")])]),t._v(" "),_("tr",[_("td",[t._v("IP地址")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("2 * (n-1)")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("n为MySQL服务器的数量,每台一个物理IP，一个虚拟IP")])]),t._v(" "),_("tr",[_("td",[t._v("监控用户")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("用于监控数据库状态的MySQL用户 (replication client)")])]),t._v(" "),_("tr",[_("td",[t._v("代理用户")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("用于MMM代理的MySQL用户 (super、replication，process)")])]),t._v(" "),_("tr",[_("td",[t._v("复制用户")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("1")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("用户配置MySQL复制的用户 (replication slave)")])])])])])}],v=a(0),i=Object(v.a)({},function(){this.$createElement;this._self._c;return this._m(0)},_,!1,null,null,null);i.options.__file="mmm.md";e.default=i.exports}}]);